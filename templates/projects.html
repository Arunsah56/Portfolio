{% extends 'base.html' %}
{% load static %}

{% block title %}My Projects - Portfolio{% endblock %}

{% block content %}
<!-- Projects Page Header -->
<section class="page-header">
    <div class="container">
        <h1 class="page-title">My Projects</h1>
        <p class="page-subtitle">Here are some of the projects I've worked on. Each project represents different skills and technologies I've mastered.</p>
    </div>
</section>

<!-- Projects Filter Section -->
<section class="projects-filter-section">
    <div class="container">
        <div class="filter-buttons">
            <button class="filter-btn active" data-filter="all">All Projects</button>
            <button class="filter-btn" data-filter="web">Web Development</button>
            <button class="filter-btn" data-filter="python">Python/Django</button>
            <button class="filter-btn" data-filter="javascript">JavaScript</button>
            <button class="filter-btn" data-filter="database">Database</button>
        </div>
    </div>
</section>

<!-- Projects Grid Section -->
<section class="projects-page">
    <div class="container">
        {% if projects %}
            <div class="projects-grid">
                {% for project in projects %}
                <div class="project-card" data-category="
                    {% if 'django' in project.technologies|lower %}python{% endif %}
                    {% if 'python' in project.technologies|lower %}python{% endif %}
                    {% if 'javascript' in project.technologies|lower %}javascript{% endif %}
                    {% if 'react' in project.technologies|lower %}javascript{% endif %}
                    {% if 'html' in project.technologies|lower %}web{% endif %}
                    {% if 'css' in project.technologies|lower %}web{% endif %}
                    {% if 'mysql' in project.technologies|lower %}database{% endif %}
                    {% if 'postgresql' in project.technologies|lower %}database{% endif %}
                    {% if 'mongodb' in project.technologies|lower %}database{% endif %}
                ">
                    <div class="project-img">
                        {% if project.image %}
                            <img src="{{ project.image.url }}" alt="{{ project.title }}">
                        {% else %}
                            <img src="{% static 'images/project-placeholder.jpg' %}" alt="{{ project.title }}">
                        {% endif %}
                        
                        {% if project.github_link or project.live_link %}
                        <div class="project-overlay">
                            <div class="project-links">
                                {% if project.github_link %}
                                <a href="{{ project.github_link }}" target="_blank" class="project-link" title="View Code">
                                    <i class="fab fa-github"></i>
                                </a>
                                {% endif %}
                                {% if project.live_link %}
                                <a href="{{ project.live_link }}" target="_blank" class="project-link" title="Live Demo">
                                    <i class="fas fa-external-link-alt"></i>
                                </a>
                                {% endif %}
                            </div>
                        </div>
                        {% endif %}
                    </div>
                    
                    <div class="project-content">
                        <h3 class="project-title">{{ project.title }}</h3>
                        <p class="project-description">{{ project.description|truncatechars:150 }}</p>
                        
                        <div class="project-tech-stack">
                            {% for tech in project.technologies.split %}
                            <span class="tech-badge">{{ tech }}</span>
                            {% endfor %}
                        </div>
                        
                        <div class="project-meta">
                            <span class="project-date">
                                <i class="far fa-calendar-alt"></i> 
                                {{ project.date_created|date:"M Y" }}
                            </span>
                            
                            <button class="btn-view-details" onclick="openProjectModal('{{ project.id }}')">
                                View Details <i class="fas fa-arrow-right"></i>
                            </button>
                        </div>
                    </div>
                </div>
                {% endfor %}
            </div>
        {% else %}
            <div class="no-projects">
                <i class="fas fa-code"></i>
                <h3>No Projects Yet</h3>
                <p>Projects will be added soon. Check back later!</p>
            </div>
        {% endif %}
    </div>
</section>

<!-- Project Details Modal -->
<div id="projectModal" class="modal">
    <div class="modal-content">
        <span class="close-modal">&times;</span>
        <div id="modalContent"></div>
    </div>
</div>
{% endblock %}

{% block extra_js %}
<script>
    // Project filtering functionality
    document.addEventListener('DOMContentLoaded', function() {
        const filterButtons = document.querySelectorAll('.filter-btn');
        const projectCards = document.querySelectorAll('.project-card');
        
        filterButtons.forEach(button => {
            button.addEventListener('click', () => {
                // Remove active class from all buttons
                filterButtons.forEach(btn => btn.classList.remove('active'));
                
                // Add active class to clicked button
                button.classList.add('active');
                
                const filterValue = button.getAttribute('data-filter');
                
                projectCards.forEach(card => {
                    if (filterValue === 'all' || card.getAttribute('data-category').includes(filterValue)) {
                        card.style.display = 'block';
                        setTimeout(() => {
                            card.style.opacity = '1';
                            card.style.transform = 'scale(1)';
                        }, 100);
                    } else {
                        card.style.opacity = '0';
                        card.style.transform = 'scale(0.8)';
                        setTimeout(() => {
                            card.style.display = 'none';
                        }, 300);
                    }
                });
            });
        });
        
        // Modal functionality
        const modal = document.getElementById('projectModal');
        const closeBtn = document.querySelector('.close-modal');
        
        window.openProjectModal = function(projectId) {
            // Find the project card
            const projectCard = event.target.closest('.project-card');
            
            if (projectCard) {
                const title = projectCard.querySelector('.project-title').textContent;
                const description = projectCard.querySelector('.project-description').textContent;
                const techStack = Array.from(projectCard.querySelectorAll('.tech-badge')).map(t => t.textContent);
                const imgSrc = projectCard.querySelector('img').src;
                const githubLink = projectCard.querySelector('.fa-github') ? projectCard.querySelector('.fa-github').closest('a').href : '#';
                const liveLink = projectCard.querySelector('.fa-external-link-alt') ? projectCard.querySelector('.fa-external-link-alt').closest('a').href : '#';
                const date = projectCard.querySelector('.project-date').textContent;
                
                const modalContent = `
                    <div class="modal-project">
                        <img src="${imgSrc}" alt="${title}" class="modal-project-img">
                        <h2 class="modal-project-title">${title}</h2>
                        <p class="modal-project-date">${date}</p>
                        <p class="modal-project-description">${description}</p>
                        <div class="modal-project-tech">
                            ${techStack.map(tech => `<span class="tech-badge">${tech}</span>`).join('')}
                        </div>
                        <div class="modal-project-links">
                            ${githubLink !== '#' ? `<a href="${githubLink}" target="_blank" class="btn btn-primary"><i class="fab fa-github"></i> View Code</a>` : ''}
                            ${liveLink !== '#' ? `<a href="${liveLink}" target="_blank" class="btn btn-secondary"><i class="fas fa-external-link-alt"></i> Live Demo</a>` : ''}
                        </div>
                    </div>
                `;
                
                document.getElementById('modalContent').innerHTML = modalContent;
                modal.style.display = 'block';
            }
        };
        
        // Close modal when clicking X
        if (closeBtn) {
            closeBtn.addEventListener('click', () => {
                modal.style.display = 'none';
            });
        }
        
        // Close modal when clicking outside
        window.addEventListener('click', (event) => {
            if (event.target === modal) {
                modal.style.display = 'none';
            }
        });
    });
</script>
{% endblock %}